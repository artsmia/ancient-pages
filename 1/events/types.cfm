<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><!--- this page draws our event calendar from the mia_web_db(the ColdFusion datasource and the SQL Server databaseare both named mia_web_db)Written by Willy Lee ---><!--- If there's no date passed in URL or otherwise, it this selects today. ---><cfif NOT IsDefined("target_date")><cfset target_date = DateFormat(Now(), "m-d-yyyy")></cfif><cfquery datasource="mia_web_db" name="GetTypes">  SELECT DISTINCT EV_Type FROM Events  WHERE EV_Type NOT LIKE '%Online%'  AND EV_Type NOT LIKE '%Exhibition%'  ORDER BY EV_Type ASC</cfquery><cfif IsDefined("Type")>  <cfquery datasource="mia_web_db" name="GetOthers">    SELECT * FROM Events, Instance    WHERE Instance.EV_ID = Events.EV_ID    AND Instance.EndDateTime > GetDate()    AND Events.EV_Type LIKE '%#type#%'    ORDER BY startdatetime ASC  </cfquery></cfif><html><head>	<title>artsmia: Events.</title><!--- <style type="text/css"><!--h3 {font-family : Sabon, Times, serif ; font-weight : 150}p.shrink {font-family : trajan, sans-serif ; font-size : .6px;}--></style> ---></head><body bgcolor="#FFFFFF" link="#0000FF" vlink="#336666" topmargin="0" leftmargin="0" marginheight="0" marginwidth="0"><!---insert nav---><cfinclude template="/site_nav/main_blue.cfm"><table border="0" width="100%" align="center" cellpadding="0" cellspacing="0">  <tr>    <td bgcolor="#85AD7A" colspan="2" align="right"><a href="/"><img src="images/logo.gif" alt="The Minneapolis Institute of Arts" border="0" align="left"></a><a href="index.cfm"><img src="images/event_title1.gif" border="0" alt=""></a></td>    <td bgcolor="#669966" colspan="2" align="left"><a href="index.cfm"><img src="images/event_title2.gif" alt="Events" border="0"></a></td>    <td bgcolor="#669966" align="right"><a href="/"><img src="images/facade1.gif" alt="" border="0"></a></td>  </tr>  <tr>    <td bgcolor="#5C857A" colspan="2" align="right"><img src="/frontpage/images/space.gif" height="1" width="1" alt=""></td>    <td bgcolor="#336666" colspan="2"><img src="/frontpage/images/space.gif" height="1" width="1" alt=""></td>    <td bgcolor="#336666" align="right"><img src="images/facade2.gif" alt=""></td>  </tr>  <tr>    <td bgcolor="#FFFFCC">&nbsp;</td>    <td valign="top" bgcolor="#FFFFCC" nowrap>    <p>&nbsp;</p>        <cfif NOT IsDefined("M1")><cfset M1 = Now()></cfif>        <cfoutput>          <cfloop index="Ms" from="1" to="2">            <h3 align="center">#DateFormat(M1, "Mmmm yyyy")#</h3>            <img src="images/grid/leftie.gif" alt="" border="0"><img src="images/grid/sunday.gif" width="25" height="21" alt="" border="0"><img src="images/grid/monday.gif" width="25" height="21" alt="" border="0"><img src="images/grid/tuesday.gif" width="25" height="21" alt="" border="0"><img src="images/grid/wednesday.gif" width="25" height="21" alt="" border="0"><img src="images/grid/thursday.gif" width="25" height="21" alt="" border="0"><img src="images/grid/friday.gif" width="25" height="21" alt="" border="0"><img src="images/grid/saturday.gif" width="25" height="21" alt="" border="0"><br><img src="images/grid/leftie.gif" alt="" border="0"><cfloop index="Ds" from="1" to="#DaysInMonth(M1)#"><cfset CalDayOfWeek = DayOfWeek(CreateDate(DatePart("yyyy", m1), Month(m1), Ds))><cfif Ds is 1 and CalDayOfWeek is not 1>#RepeatString('<img src="images/grid/blankie.gif" border="0" alt=" ">', Evaluate(CalDayOfWeek -1))#</cfif><a href="index.cfm?target_date=#DatePart("yyyy", m1)#-#Month(m1)#-#Ds#"><img src="images/grid/#Ds#.gif" border="0" alt="#Ds#"></a><cfif CalDayOfWeek is "7" and DaysInMonth(M1) is not Ds><br><img src="images/grid/leftie.gif" alt="" border="0"></cfif></cfloop><cfset M1 = DateAdd("m", "1", M1)></cfloop>        </cfoutput>          </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>    <td align="left" valign="top">    <p>&nbsp;</p>    <div align="center">      <a href="index.cfm"><img src="images/by_day.gif" alt="Events by Day" border="0"></a>      <a href="week.cfm"><img src="images/by_week.gif" alt="Events by Week" border="0"></a>      <a href="types.cfm"><img src="images/by_type.gif" alt="Events by Type" border="0"></a>    </div>      <cfset LastDate = "">      <cfif IsDefined("type")>	  <h3><cfoutput>#Type#</cfoutput></h3>      <cfoutput query="GetOthers">        <cfif LastDate is not DateFormat(StartDateTime, "Dddd, Mmmm d, yyyy")>        <b>#DateFormat(StartDateTime, "Dddd, Mmmm d, yyyy")#</b>        <cfset LastDate = DateFormat(StartDateTime, "Dddd, Mmmm d, yyyy")>        </cfif>          <blockquote>            <p><a href="types.cfm?type=#URLEncodedFormat(EV_Type)#"><img src="images/#SpanExcluding(EV_Type, " ")#.gif" border="0"></a><br>            <b>#EV_Title#</b><br>			<cfif Len(EV_Display_Date) gt 0>#EV_Display_Date#</cfif>            <cfif TimeFormat(StartDateTime, "h:mm tt") is not "12:00AM">#TimeFormat(StartDateTime, "h:mm tt")#</cfif>            <cfif EndDateTime is not StartDateTime>&##150; #TimeFormat(EndDateTime, "h:mm tt")#</cfif>            <cfif Len(EV_Location) gt 0><br>#EV_location#</cfif>            </p>            <p class="shrink">#ParagraphFormat(EV_Description)#</p>          </blockquote>      </cfoutput>    <cfelse>      <h3>Events by Type</h3>      <p>Select a type of event.</p>      <cfoutput query="GetTypes">	    <p><a href="types.cfm?type=#URLEncodedFormat(EV_Type)#"><img src="images/#SpanExcluding(EV_Type, " ")#.gif" border="0" alt="#EV_Type#"></a></p>	  </cfoutput>    </cfif>	<p>&nbsp;</p>    </td>    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>  </tr></table><!---insert nav---><cfinclude template="/site_nav/main_blue.cfm"></body></html>